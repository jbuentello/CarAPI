<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CarAPI</title>
</head>
<body>
     
            <div id="topics"></div>
                    
                <form id="Car-Search">
                            <label for="car-input">Car Search</label>
                            <input type="text" id="car-input">
                            <input id="add-car" type="submit">
                            <!-- value="Search"> -->
                </form>
                            
            <div id="carInfo"></div>
              

 
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript">
var topics = ["Supra", "Mustang","Lancer Evo", "Corvette", "Porsche","GTR"];

function CarSearch(car) {

    var car = $(this).attr("data-name");
    console.log(car);
    //Giphy API URL

    var queryURL = "https://api.giphy.com/v1/gifs/search?api_key=vKZAPU6BYAZ2vLLsyDzeFBYL1FKIMCvu&q=" +car+ "&limit=10&offset=0&rating=PG-13&lang=en";


    //Ajax using method "GET"
    $.ajax({
        url: queryURL,
        method:"GET"
    }).then(function(response){
        
        var results = response.data
        console.log(results)
        console.log(results[9].rating);

        for (var i = 0; i < results.length; i++) {
            var carDiv = $("<div class=AppCar>");
            var rating = results[i].rating;
            var ratingHTMl = $("<p>").text(rating);
            $(".AppCar").append(ratingHTMl); 
            var CarImage= results[i].images.preview_gif.url;
            // var ImageDiv= $("<div class=UrlImage>");
            var ImageHTML =$("<img>").attr("src", CarImage);
            $(".AppCar").append(ImageHTML);
            $("#carInfo").prepend(carDiv);

            // console.log(ImageHTMl); 
            
        }
        
        // $("#carInfo").text(JSON.stringify(results));
    });
};

function onPressButton() {
    $("#topics").empty();

    //Reuse previous loop for diaplying buttons

    for (var i = 0; i < topics.length; i++){
        var addButton = $("<button>");
        addButton.addClass("car");
        addButton.attr("data-name", topics[i]);
        addButton.text(topics[i]);

        $("#topics").append(addButton);       
    }
};

$("#add-car").on("click", function(event){
    event.preventDefault();

    var car = $("#car-input").val();

    topics.push(car);
    
    onPressButton();
});


$(document).on("click", ".car", CarSearch)
onPressButton();

//Connect to Giphy API using ajax.
//Select the proper link to search for.
//Create buttons to search the data
//Once the data is pulled, set the information to the proper place
//Set 
</script>
</body>
</html>
